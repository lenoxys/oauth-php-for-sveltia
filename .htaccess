<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /oauth/
    
    # Protect debug log from direct access
    RewriteRule ^debug\.log$ - [F,L]
    
    # If the requested file or directory does not exist
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    
    # Rewrite all requests to index.php, preserving the path and query string
    RewriteRule ^(.*)$ index.php [L,QSA]
</IfModule>

# Ensure PHP handles all requests
<IfModule mod_dir.c>
    DirectoryIndex index.php
</IfModule>

# Deny direct access to debug log
<Files "debug.log">
    Deny from all
</Files>
